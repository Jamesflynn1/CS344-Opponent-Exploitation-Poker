import pandas as pd
import time
import sys
#See 
#https://github.com/deepmind/open_spiel/blob/master/open_spiel/python/algorithms/mccfr.py
#For documentation and implementation details

low_quality = 100
med_quality = 1000
high_quality = 10000

import EFR
from open_spiel.python.algorithms.external_sampling_mccfr import ExternalSamplingSolver
import StoreTabularPolicy
import pyspiel

FL_game = 'leduc_poker'
FL_iterations = high_quality
FL_players = 2

game = pyspiel.load_game(FL_game, {"players": FL_players})

mccfr_solution = ExternalSamplingSolver(game)

for i in range(FL_iterations):
    mccfr_solution.iteration()
    print("Iteration" + str(i))

StoreTabularPolicy.save_tabular_policy("Policy/MCCFR_high.csv", mccfr_solution.average_policy().to_tabular())